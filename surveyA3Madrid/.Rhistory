Datos_Finales_Aux <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux<-Datos_Finales_Aux %>% select(-starts_with("P16"))%>% select(-starts_with("P17"))%>% select(-starts_with("P20"))%>% select(-starts_with("P21"))
Datos_Finales_Aux$seccion_censal<-as.character(Datos_Finales_Aux$seccion_censal)
Datos_Finales_Aux<-Datos_Finales_Aux %>% mutate(CensusSection = case_when(
seccion_censal=="2812301042" ~ "2812301008",
seccion_censal=="2812301043" ~ "2812301019",
seccion_censal=="2812301044" ~ "2812301022",
seccion_censal=="2812301045" ~ "2812301037",
TRUE ~ seccion_censal))
# Output_Cluster <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster$CensusSection<-as.character(Output_Cluster$CensusSection)
Datos_full<-full_join(Datos_Finales_Aux,Output_Cluster,by="CensusSection")
Datos_full$elegiria_metro<-as.numeric(Datos_full$elegiria_metro)
Datos_full$elegiria_bus<-as.numeric(Datos_full$elegiria_bus)
Datos_full$current_toll<-factor(Datos_full$current_toll,levels=c("1","2"),labels=c("Si","No"))
Datos_full$wtp<-factor(Datos_full$wtp,levels = c("1","2","3"),labels=c("Si","No","No_Destino"))
Datos_full$abono_mensual<-factor(Datos_full$abono_mensual,levels = c("1","2"),labels=c("Si","No"))
Datos_full$carpooling<-factor(Datos_full$carpooling,levels=c("1","2"),labels=c("Si","No"))
Datos_full$seccion_censal<-factor(Datos_full$seccion_censal)
Datos_full$cluster_A_1<-factor(Datos_full$cluster_A_1)
Datos_full$cluster_A_2<-factor(Datos_full$cluster_A_2)
Datos_full$cluster_A_4<-factor(Datos_full$cluster_A_4)
Datos_full$cluster_A_5<-factor(Datos_full$cluster_A_5)
Datos_full$cluster_A_7<-factor(Datos_full$cluster_A_7)
Datos_full$cluster_A_8<-factor(Datos_full$cluster_A_8)
Datos_full$cluster_A_10<-factor(Datos_full$cluster_A_10)
Datos_full$cluster_A_11<-factor(Datos_full$cluster_A_11)
Datos_full$cluster_RA_1<-factor(Datos_full$cluster_RA_1)
Datos_full$cluster_RA_2<-factor(Datos_full$cluster_RA_2)
Datos_full$cluster_RA_3<-factor(Datos_full$cluster_RA_3)
Datos_full$cluster_RA_4<-factor(Datos_full$cluster_RA_4)
Datos_full$cluster_RA_5<-factor(Datos_full$cluster_RA_5)
Datos_full$cluster_RA_6<-factor(Datos_full$cluster_RA_6)
Datos_full$cluster_RA_7<-factor(Datos_full$cluster_RA_7)
Datos_full$cluster_RA_8<-factor(Datos_full$cluster_RA_8)
Datos_full$cluster_RA_9<-factor(Datos_full$cluster_RA_9)
Datos_full$cluster_RA_10<-factor(Datos_full$cluster_RA_10)
Datos_full$cluster_RA_11<-factor(Datos_full$cluster_RA_11)
Datos_full$cluster_RA_12<-factor(Datos_full$cluster_RA_12)
Datos_full$zona_metro<-factor(Datos_full$zona_metro)
Datos_full$Parada_bus<-factor(Datos_full$Parada_bus)
Datos_full$municipio <- factor(Datos_full$municipio, levels=c(28014,28123),labels = c("Arganda","Rivas"))
Datos_full$edad_cat<-factor(Datos_full$edad_cat,levels = c(1:6),labels=c("15 o menos","De 16 a 26","De 27 a 34","De 35 a 49","De 50 a 64","Mayor de 64"))
Datos_full$genero<-factor(Datos_full$genero,levels = c(1,2),labels=c("Hombre","Mujer"))
Datos_full$ingreso<-factor(Datos_full$ingreso,levels = c(1,2,3,4,5,99),labels=c("Menos_900","900_1600","1600_2500","2500_3000","Mas_3000","NS_NC"))
Datos_full$estudios<-factor(Datos_full$estudios,levels = c(1:4),labels=c("Sin_estudios","Estudios_primarios","Estudios_Secundarios","Estudios_Universitarios"))
Datos_full$sit_laboral<- factor(Datos_full$sit_laboral,levels=c(1:9),labels=c("Employed","Student","Employed_Student","Unpaid_household","Retire","Pensiones","Unemployed_Looking","Unemployed_Not_Looking","Other"))
Datos_full$vehiculo <- factor(Datos_full$vehiculo,levels=c(1:5),labels=c("No","Yes_Driver","Yes_ST_Driver","Yes_No_Driver","Yes_Passenger"))
Datos_full$carnet <- factor(Datos_full$carnet, levels=c(1:5),labels=c("NO","DeMoto","DeCoche","DeMotoYCoche","NoProcede"))
Datos_full$abono <-factor(Datos_full$abono,levels = c(2,1),labels=c("No","Yes"))
Datos_full$frec_madrid<- factor(Datos_full$frec_madrid,levels=c(1:3),labels=c("More_3days","1-3days","1_2month"))
Datos_full$frec_viaje<- factor(Datos_full$frec_viaje,levels=c(1:4),labels=c("4 o mas dias a la semana","1-3 dias a la semana","1-2 veces al mes","Menos de una vez al mes"))
Datos_full$modo <- factor(Datos_full$modo, levels= c(1:7),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional"))
Datos_full$modo_bis <- factor(Datos_full$modo_bis, levels= c(1:8),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional","R3"))
Datos_full$tipo_dia <- factor(Datos_full$tipo_dia, levels=c(1:7),labels = c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))
Datos_full$tipo_dia2 <- factor(Datos_full$tipo_dia2, levels=c("1","1","1","1","1","2","3"),labels = c("Weekday","Weekday","Weekday","Weekday","Weekday","Saturday","Sunday"))
Datos_full$motivo_viaje <- factor(Datos_full$motivo_viaje, levels=c(1:8),labels = c("Work_Studies","Working_Affairs","Personal_Affairs","Leisure","Shopping","Doctor","Visiting_Friends","Other"))
Datos_full$motivo_viaje_2<-factor(Datos_full$motivo_viaje_2, levels=c("1","2"),labels=c("Work_Studies","Non_Work_Studies"))
Datos_full$ruta<-factor(Datos_full$ruta,levels=c(1:2),labels=c("A3","R3"))
Datos_full$P15_B<-factor(Datos_full$P15_B,levels=c(1:2),labels=c("Conductor","Acompanante"))
Datos_full$hora_franja <- factor(Datos_full$hora_franja, levels=c("1","2","3","4","5","6"),labels = c("peak morning","non peak morning","afternoon","peak evening","non peak evening","night"))
Datos_full$solo <- factor(Datos_full$solo, levels = c(1:3),labels=c("Solo","Acompanado","Acompanado_Menores"))
Datos_full$combinar<- factor(Datos_full$combinar, levels = c(1:2),labels=c("Si","No"))
Datos_full$aspectos<- factor(Datos_full$aspectos, levels = c(1:4),labels=c("Tiempo de viaje por congestion (nivel de trafico)","Incidencias en el medio elegido: obras, accidentes, huelgas en transporte publico","Meteorologia","Protocolos de contaminacion en Madrid capital"))
Datos_full<-Datos_full %>% mutate(conocimiento=case_when(
current_toll_diff< -0.5 ~ 1,
current_toll_diff> 0.5 ~ 2,
current_toll == "No" ~ 3,
TRUE ~ 0
))
Datos_full$conocimiento<-factor(Datos_full$conocimiento)
Datos_full<-Datos_full %>% mutate(ahorrotiempo1=tiempo_viaje - Duracion_Coche_R3)
Datos_full<-Datos_full %>% mutate(tiempo2 = tiempo_viaje * tiempo_viaje)
openxlsx::write.xlsx(Datos_full,"Datos_full.xlsx")
dataSurveyA3<-Datos_full
usethis::use_data(Datos_full, overwrite = T)
dataSurveyA3<-Datos_full[,c("genero","edad","edad_cat","municipio")]
usethis::use_data(dataSurveyA3, overwrite = T)
devtools::document()
library(surveyA3Madrid)
?dataSurveyA3
data(dataSurveyA3)
force(dataSurveyA3)
View(dataSurveyA3)
knitr::opts_chunk$set(echo = FALSE)
# setwd("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_R")
setwd("~/OneDrive - UNED/Papers/Paper 3/Models_R")
library("lme4")
library("readxl")
library("tidyverse")
library("lmtest")
# Datos_Finales_Aux <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux<-Datos_Finales_Aux %>% select(-starts_with("P16"))%>% select(-starts_with("P17"))%>% select(-starts_with("P20"))%>% select(-starts_with("P21"))
Datos_Finales_Aux$seccion_censal<-as.character(Datos_Finales_Aux$seccion_censal)
Datos_Finales_Aux<-Datos_Finales_Aux %>% mutate(CensusSection = case_when(
seccion_censal=="2812301042" ~ "2812301008",
seccion_censal=="2812301043" ~ "2812301019",
seccion_censal=="2812301044" ~ "2812301022",
seccion_censal=="2812301045" ~ "2812301037",
TRUE ~ seccion_censal))
# Output_Cluster <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster$CensusSection<-as.character(Output_Cluster$CensusSection)
Datos_full<-full_join(Datos_Finales_Aux,Output_Cluster,by="CensusSection")
Datos_full$elegiria_metro<-as.numeric(Datos_full$elegiria_metro)
Datos_full$elegiria_bus<-as.numeric(Datos_full$elegiria_bus)
Datos_full$current_toll<-factor(Datos_full$current_toll,levels=c("1","2"),labels=c("Si","No"))
Datos_full$wtp<-factor(Datos_full$wtp,levels = c("1","2","3"),labels=c("Si","No","No_Destino"))
Datos_full$abono_mensual<-factor(Datos_full$abono_mensual,levels = c("1","2"),labels=c("Si","No"))
Datos_full$carpooling<-factor(Datos_full$carpooling,levels=c("1","2"),labels=c("Si","No"))
Datos_full$seccion_censal<-factor(Datos_full$seccion_censal)
Datos_full$cluster_A_1<-factor(Datos_full$cluster_A_1)
Datos_full$cluster_A_2<-factor(Datos_full$cluster_A_2)
Datos_full$cluster_A_4<-factor(Datos_full$cluster_A_4)
Datos_full$cluster_A_5<-factor(Datos_full$cluster_A_5)
Datos_full$cluster_A_7<-factor(Datos_full$cluster_A_7)
Datos_full$cluster_A_8<-factor(Datos_full$cluster_A_8)
Datos_full$cluster_A_10<-factor(Datos_full$cluster_A_10)
Datos_full$cluster_A_11<-factor(Datos_full$cluster_A_11)
Datos_full$cluster_RA_1<-factor(Datos_full$cluster_RA_1)
Datos_full$cluster_RA_2<-factor(Datos_full$cluster_RA_2)
Datos_full$cluster_RA_3<-factor(Datos_full$cluster_RA_3)
Datos_full$cluster_RA_4<-factor(Datos_full$cluster_RA_4)
Datos_full$cluster_RA_5<-factor(Datos_full$cluster_RA_5)
Datos_full$cluster_RA_6<-factor(Datos_full$cluster_RA_6)
Datos_full$cluster_RA_7<-factor(Datos_full$cluster_RA_7)
Datos_full$cluster_RA_8<-factor(Datos_full$cluster_RA_8)
Datos_full$cluster_RA_9<-factor(Datos_full$cluster_RA_9)
Datos_full$cluster_RA_10<-factor(Datos_full$cluster_RA_10)
Datos_full$cluster_RA_11<-factor(Datos_full$cluster_RA_11)
Datos_full$cluster_RA_12<-factor(Datos_full$cluster_RA_12)
Datos_full$zona_metro<-factor(Datos_full$zona_metro)
Datos_full$Parada_bus<-factor(Datos_full$Parada_bus)
Datos_full$municipio <- factor(Datos_full$municipio, levels=c(28014,28123),labels = c("Arganda","Rivas"))
Datos_full$edad_cat<-factor(Datos_full$edad_cat,levels = c(1:6),labels=c("15 o menos","De 16 a 26","De 27 a 34","De 35 a 49","De 50 a 64","Mayor de 64"))
Datos_full$genero<-factor(Datos_full$genero,levels = c(1,2),labels=c("Hombre","Mujer"))
Datos_full$ingreso<-factor(Datos_full$ingreso,levels = c(1,2,3,4,5,99),labels=c("Menos_900","900_1600","1600_2500","2500_3000","Mas_3000","NS_NC"))
Datos_full$estudios<-factor(Datos_full$estudios,levels = c(1:4),labels=c("Sin_estudios","Estudios_primarios","Estudios_Secundarios","Estudios_Universitarios"))
Datos_full$sit_laboral<- factor(Datos_full$sit_laboral,levels=c(1:9),labels=c("Employed","Student","Employed_Student","Unpaid_household","Retire","Pensiones","Unemployed_Looking","Unemployed_Not_Looking","Other"))
Datos_full$vehiculo <- factor(Datos_full$vehiculo,levels=c(1:5),labels=c("No","Yes_Driver","Yes_ST_Driver","Yes_No_Driver","Yes_Passenger"))
Datos_full$carnet <- factor(Datos_full$carnet, levels=c(1:5),labels=c("NO","DeMoto","DeCoche","DeMotoYCoche","NoProcede"))
Datos_full$abono <-factor(Datos_full$abono,levels = c(2,1),labels=c("No","Yes"))
Datos_full$frec_madrid<- factor(Datos_full$frec_madrid,levels=c(1:3),labels=c("More_3days","1-3days","1_2month"))
Datos_full$frec_viaje<- factor(Datos_full$frec_viaje,levels=c(1:4),labels=c("4 o mas dias a la semana","1-3 dias a la semana","1-2 veces al mes","Menos de una vez al mes"))
Datos_full$modo <- factor(Datos_full$modo, levels= c(1:7),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional"))
Datos_full$modo_bis <- factor(Datos_full$modo_bis, levels= c(1:8),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional","R3"))
Datos_full$tipo_dia <- factor(Datos_full$tipo_dia, levels=c(1:7),labels = c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))
Datos_full$tipo_dia2 <- factor(Datos_full$tipo_dia2, levels=c("1","1","1","1","1","2","3"),labels = c("Weekday","Weekday","Weekday","Weekday","Weekday","Saturday","Sunday"))
Datos_full$motivo_viaje <- factor(Datos_full$motivo_viaje, levels=c(1:8),labels = c("Work_Studies","Working_Affairs","Personal_Affairs","Leisure","Shopping","Doctor","Visiting_Friends","Other"))
Datos_full$motivo_viaje_2<-factor(Datos_full$motivo_viaje_2, levels=c("1","2"),labels=c("Work_Studies","Non_Work_Studies"))
Datos_full$ruta<-factor(Datos_full$ruta,levels=c(1:2),labels=c("A3","R3"))
Datos_full$P15_B<-factor(Datos_full$P15_B,levels=c(1:2),labels=c("Conductor","Acompanante"))
Datos_full$hora_franja <- factor(Datos_full$hora_franja, levels=c("1","2","3","4","5","6"),labels = c("peak morning","non peak morning","afternoon","peak evening","non peak evening","night"))
Datos_full$solo <- factor(Datos_full$solo, levels = c(1:3),labels=c("Solo","Acompanado","Acompanado_Menores"))
Datos_full$combinar<- factor(Datos_full$combinar, levels = c(1:2),labels=c("Si","No"))
Datos_full$aspectos<- factor(Datos_full$aspectos, levels = c(1:4),labels=c("Tiempo de viaje por congestion (nivel de trafico)","Incidencias en el medio elegido: obras, accidentes, huelgas en transporte publico","Meteorologia","Protocolos de contaminacion en Madrid capital"))
Datos_full<-Datos_full %>% mutate(conocimiento=case_when(
current_toll_diff< -0.5 ~ 1,
current_toll_diff> 0.5 ~ 2,
current_toll == "No" ~ 3,
TRUE ~ 0
))
Datos_full$conocimiento<-factor(Datos_full$conocimiento)
Datos_full<-Datos_full %>% mutate(ahorrotiempo1=tiempo_viaje - Duracion_Coche_R3)
Datos_full<-Datos_full %>% mutate(tiempo2 = tiempo_viaje * tiempo_viaje)
openxlsx::write.xlsx(Datos_full,"Datos_full.xlsx")
dataSurveyA3<-Datos_full[,c("genero","edad","edad_cat","municipio")]
usethis::use_data(dataSurveyA3, overwrite = T)
View(Datos_full)
length(unique(Datos_full$ID_CONTACTO))
length(unique(Datos_full$REGISTRO))
names(Datos_full)
dataSurveyA3<-Datos_full[,c("REGISTRO","genero","edad","edad_cat","municipio","frec_madrid","sit_laboral","ingreso","estudios","carnet","vehiculo","abono","seccion_censal","tipo_dia","motivo_viaje","modo")]
usethis::use_data(dataSurveyA3, overwrite = T)
View(dataSurveyA3)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(surveyA3Madrid)
?dataSurveyA3
data("dataSurveyA3")
force(dataSurveyA3)
force(dataSurveyA3)
View(dataSurveyA3)
knitr::opts_chunk$set(echo = FALSE)
# setwd("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_R")
setwd("~/OneDrive - UNED/Papers/Paper 3/Models_R")
library("lme4")
library("readxl")
library("tidyverse")
library("lmtest")
# Datos_Finales_Aux <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux<-Datos_Finales_Aux %>% select(-starts_with("P16"))%>% select(-starts_with("P17"))%>% select(-starts_with("P20"))%>% select(-starts_with("P21"))
Datos_Finales_Aux$seccion_censal<-as.character(Datos_Finales_Aux$seccion_censal)
Datos_Finales_Aux<-Datos_Finales_Aux %>% mutate(CensusSection = case_when(
seccion_censal=="2812301042" ~ "2812301008",
seccion_censal=="2812301043" ~ "2812301019",
seccion_censal=="2812301044" ~ "2812301022",
seccion_censal=="2812301045" ~ "2812301037",
TRUE ~ seccion_censal))
# Output_Cluster <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster$CensusSection<-as.character(Output_Cluster$CensusSection)
Datos_full<-full_join(Datos_Finales_Aux,Output_Cluster,by="CensusSection")
Datos_full$elegiria_metro<-as.numeric(Datos_full$elegiria_metro)
Datos_full$elegiria_bus<-as.numeric(Datos_full$elegiria_bus)
Datos_full$current_toll<-factor(Datos_full$current_toll,levels=c("1","2"),labels=c("Si","No"))
Datos_full$wtp<-factor(Datos_full$wtp,levels = c("1","2","3"),labels=c("Si","No","No_Destino"))
Datos_full$abono_mensual<-factor(Datos_full$abono_mensual,levels = c("1","2"),labels=c("Si","No"))
Datos_full$carpooling<-factor(Datos_full$carpooling,levels=c("1","2"),labels=c("Si","No"))
Datos_full$seccion_censal<-factor(Datos_full$seccion_censal)
Datos_full$cluster_A_1<-factor(Datos_full$cluster_A_1)
Datos_full$cluster_A_2<-factor(Datos_full$cluster_A_2)
Datos_full$cluster_A_4<-factor(Datos_full$cluster_A_4)
Datos_full$cluster_A_5<-factor(Datos_full$cluster_A_5)
Datos_full$cluster_A_7<-factor(Datos_full$cluster_A_7)
Datos_full$cluster_A_8<-factor(Datos_full$cluster_A_8)
Datos_full$cluster_A_10<-factor(Datos_full$cluster_A_10)
Datos_full$cluster_A_11<-factor(Datos_full$cluster_A_11)
Datos_full$cluster_RA_1<-factor(Datos_full$cluster_RA_1)
Datos_full$cluster_RA_2<-factor(Datos_full$cluster_RA_2)
Datos_full$cluster_RA_3<-factor(Datos_full$cluster_RA_3)
Datos_full$cluster_RA_4<-factor(Datos_full$cluster_RA_4)
Datos_full$cluster_RA_5<-factor(Datos_full$cluster_RA_5)
Datos_full$cluster_RA_6<-factor(Datos_full$cluster_RA_6)
Datos_full$cluster_RA_7<-factor(Datos_full$cluster_RA_7)
Datos_full$cluster_RA_8<-factor(Datos_full$cluster_RA_8)
Datos_full$cluster_RA_9<-factor(Datos_full$cluster_RA_9)
Datos_full$cluster_RA_10<-factor(Datos_full$cluster_RA_10)
Datos_full$cluster_RA_11<-factor(Datos_full$cluster_RA_11)
Datos_full$cluster_RA_12<-factor(Datos_full$cluster_RA_12)
Datos_full$zona_metro<-factor(Datos_full$zona_metro)
Datos_full$Parada_bus<-factor(Datos_full$Parada_bus)
Datos_full$municipio <- factor(Datos_full$municipio, levels=c(28014,28123),labels = c("Arganda","Rivas"))
Datos_full$edad_cat<-factor(Datos_full$edad_cat,levels = c(1:6),labels=c("15 o menos","De 16 a 26","De 27 a 34","De 35 a 49","De 50 a 64","Mayor de 64"))
Datos_full$genero<-factor(Datos_full$genero,levels = c(1,2),labels=c("Hombre","Mujer"))
Datos_full$ingreso<-factor(Datos_full$ingreso,levels = c(1,2,3,4,5,99),labels=c("Menos_900","900_1600","1600_2500","2500_3000","Mas_3000","NS_NC"))
Datos_full$estudios<-factor(Datos_full$estudios,levels = c(1:4),labels=c("Sin_estudios","Estudios_primarios","Estudios_Secundarios","Estudios_Universitarios"))
Datos_full$sit_laboral<- factor(Datos_full$sit_laboral,levels=c(1:9),labels=c("Employed","Student","Employed_Student","Unpaid_household","Retire","Pensiones","Unemployed_Looking","Unemployed_Not_Looking","Other"))
Datos_full$vehiculo <- factor(Datos_full$vehiculo,levels=c(1:5),labels=c("No","Yes_Driver","Yes_ST_Driver","Yes_No_Driver","Yes_Passenger"))
Datos_full$carnet <- factor(Datos_full$carnet, levels=c(1:5),labels=c("NO","DeMoto","DeCoche","DeMotoYCoche","NoProcede"))
Datos_full$abono <-factor(Datos_full$abono,levels = c(2,1),labels=c("No","Yes"))
Datos_full$frec_madrid<- factor(Datos_full$frec_madrid,levels=c(1:3),labels=c("More_3days","1-3days","1_2month"))
Datos_full$frec_viaje<- factor(Datos_full$frec_viaje,levels=c(1:4),labels=c("4 o mas dias a la semana","1-3 dias a la semana","1-2 veces al mes","Menos de una vez al mes"))
Datos_full$modo <- factor(Datos_full$modo, levels= c(1:7),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional"))
Datos_full$modo_bis <- factor(Datos_full$modo_bis, levels= c(1:8),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional","R3"))
Datos_full$tipo_dia <- factor(Datos_full$tipo_dia, levels=c(1:7),labels = c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))
Datos_full$tipo_dia2 <- factor(Datos_full$tipo_dia2, levels=c("1","1","1","1","1","2","3"),labels = c("Weekday","Weekday","Weekday","Weekday","Weekday","Saturday","Sunday"))
Datos_full$motivo_viaje <- factor(Datos_full$motivo_viaje, levels=c(1:8),labels = c("Work_Studies","Working_Affairs","Personal_Affairs","Leisure","Shopping","Doctor","Visiting_Friends","Other"))
Datos_full$motivo_viaje_2<-factor(Datos_full$motivo_viaje_2, levels=c("1","2"),labels=c("Work_Studies","Non_Work_Studies"))
Datos_full$ruta<-factor(Datos_full$ruta,levels=c(1:2),labels=c("A3","R3"))
Datos_full$P15_B<-factor(Datos_full$P15_B,levels=c(1:2),labels=c("Conductor","Acompanante"))
Datos_full$hora_franja <- factor(Datos_full$hora_franja, levels=c("1","2","3","4","5","6"),labels = c("peak morning","non peak morning","afternoon","peak evening","non peak evening","night"))
Datos_full$solo <- factor(Datos_full$solo, levels = c(1:3),labels=c("Solo","Acompanado","Acompanado_Menores"))
Datos_full$combinar<- factor(Datos_full$combinar, levels = c(1:2),labels=c("Si","No"))
Datos_full$aspectos<- factor(Datos_full$aspectos, levels = c(1:4),labels=c("Tiempo de viaje por congestion (nivel de trafico)","Incidencias en el medio elegido: obras, accidentes, huelgas en transporte publico","Meteorologia","Protocolos de contaminacion en Madrid capital"))
Datos_full<-Datos_full %>% mutate(conocimiento=case_when(
current_toll_diff< -0.5 ~ 1,
current_toll_diff> 0.5 ~ 2,
current_toll == "No" ~ 3,
TRUE ~ 0
))
Datos_full$conocimiento<-factor(Datos_full$conocimiento)
Datos_full<-Datos_full %>% mutate(ahorrotiempo1=tiempo_viaje - Duracion_Coche_R3)
Datos_full<-Datos_full %>% mutate(tiempo2 = tiempo_viaje * tiempo_viaje)
openxlsx::write.xlsx(Datos_full,"Datos_full.xlsx")
View(Datos_full)
names(Datos_full)
dataSurveyA3<-Datos_full[,c("REGISTRO","genero","edad","edad_cat","municipio","frec_madrid","sit_laboral","ingreso","estudios","carnet","vehiculo","abono","seccion_censal","tipo_dia","motivo_viaje",,"P12","tiempo_viaje","modo","ruta","P15_B","combinar","solo","frec_viaje",,"aspectos","current_toll","current_toll_tarifa","wtp","wtp_tarifa","abono_mensual","abono_mensual_tarifa","carpooling","carpooling_descuento","elegiria_bus_arganda","elegiria_bus_rivas","elegiria_metro_arganda","elegiria_metro_rivas")]
dataSurveyA3<-Datos_full[c("REGISTRO","genero","edad","edad_cat","municipio","frec_madrid","sit_laboral","ingreso","estudios","carnet","vehiculo","abono","seccion_censal","tipo_dia","motivo_viaje",,"P12","tiempo_viaje","modo","ruta","P15_B","combinar","solo","frec_viaje",,"aspectos","current_toll","current_toll_tarifa","wtp","wtp_tarifa","abono_mensual","abono_mensual_tarifa","carpooling","carpooling_descuento","elegiria_bus_arganda","elegiria_bus_rivas","elegiria_metro_arganda","elegiria_metro_rivas")]
dataSurveyA3<-Datos_full[,c("REGISTRO","genero","edad","edad_cat","municipio","frec_madrid","sit_laboral","ingreso","estudios","carnet","vehiculo","abono","seccion_censal","tipo_dia","motivo_viaje","P12","tiempo_viaje","modo","ruta","P15_B","combinar","solo","frec_viaje","aspectos","current_toll","current_toll_tarifa","wtp","wtp_tarifa","abono_mensual","abono_mensual_tarifa","carpooling","carpooling_descuento","elegiria_bus_arganda","elegiria_bus_rivas","elegiria_metro_arganda","elegiria_metro_rivas")]
usethis::use_data(dataSurveyA3, overwrite = T)
levels(dataSurveyA3$frec_madrid)
levels(dataSurveyA3$ingreso)
levels(dataSurveyA3$estudios)
levels(dataSurveyA3$sit_laboral)
levels(dataSurveyA3$abono)
levels(dataSurveyA3$vehiculo)
levels(dataSurveyA3$carnet)
levels(dataSurveyA3$tipo_dia)
levels(dataSurveyA3$motivo_viaje)
levels(dataSurveyA3$modo)
devtools::document()
devtools::document()
library(surveyA3Madrid)
devtools::document()
library(surveyA3Madrid)
?dataSurveyA3
levels(dataSurveyA3$edad_cat)
knitr::opts_chunk$set(echo = FALSE)
# setwd("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_R")
setwd("~/OneDrive - UNED/Papers/Paper 3/Models_R")
library("lme4")
library("readxl")
library("tidyverse")
library("lmtest")
# Datos_Finales_Aux <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Models_Stata/Datos_Finales_Aux_FR_20191027.xlsx")
Datos_Finales_Aux<-Datos_Finales_Aux %>% select(-starts_with("P16"))%>% select(-starts_with("P17"))%>% select(-starts_with("P20"))%>% select(-starts_with("P21"))
Datos_Finales_Aux$seccion_censal<-as.character(Datos_Finales_Aux$seccion_censal)
Datos_Finales_Aux<-Datos_Finales_Aux %>% mutate(CensusSection = case_when(
seccion_censal=="2812301042" ~ "2812301008",
seccion_censal=="2812301043" ~ "2812301019",
seccion_censal=="2812301044" ~ "2812301022",
seccion_censal=="2812301045" ~ "2812301037",
TRUE ~ seccion_censal))
# Output_Cluster <- read_excel("C:/Users/romero/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster <- read_excel("~/OneDrive - UNED/Papers/Paper 3/Excels_Resultados/Output_Cluster.xlsx")
Output_Cluster$CensusSection<-as.character(Output_Cluster$CensusSection)
Datos_full<-full_join(Datos_Finales_Aux,Output_Cluster,by="CensusSection")
Datos_full$elegiria_metro<-as.numeric(Datos_full$elegiria_metro)
Datos_full$elegiria_bus<-as.numeric(Datos_full$elegiria_bus)
Datos_full$current_toll<-factor(Datos_full$current_toll,levels=c("1","2"),labels=c("Si","No"))
Datos_full$wtp<-factor(Datos_full$wtp,levels = c("1","2","3"),labels=c("Si","No","No_Destino"))
Datos_full$abono_mensual<-factor(Datos_full$abono_mensual,levels = c("1","2"),labels=c("Si","No"))
Datos_full$carpooling<-factor(Datos_full$carpooling,levels=c("1","2"),labels=c("Si","No"))
Datos_full$seccion_censal<-factor(Datos_full$seccion_censal)
Datos_full$cluster_A_1<-factor(Datos_full$cluster_A_1)
Datos_full$cluster_A_2<-factor(Datos_full$cluster_A_2)
Datos_full$cluster_A_4<-factor(Datos_full$cluster_A_4)
Datos_full$cluster_A_5<-factor(Datos_full$cluster_A_5)
Datos_full$cluster_A_7<-factor(Datos_full$cluster_A_7)
Datos_full$cluster_A_8<-factor(Datos_full$cluster_A_8)
Datos_full$cluster_A_10<-factor(Datos_full$cluster_A_10)
Datos_full$cluster_A_11<-factor(Datos_full$cluster_A_11)
Datos_full$cluster_RA_1<-factor(Datos_full$cluster_RA_1)
Datos_full$cluster_RA_2<-factor(Datos_full$cluster_RA_2)
Datos_full$cluster_RA_3<-factor(Datos_full$cluster_RA_3)
Datos_full$cluster_RA_4<-factor(Datos_full$cluster_RA_4)
Datos_full$cluster_RA_5<-factor(Datos_full$cluster_RA_5)
Datos_full$cluster_RA_6<-factor(Datos_full$cluster_RA_6)
Datos_full$cluster_RA_7<-factor(Datos_full$cluster_RA_7)
Datos_full$cluster_RA_8<-factor(Datos_full$cluster_RA_8)
Datos_full$cluster_RA_9<-factor(Datos_full$cluster_RA_9)
Datos_full$cluster_RA_10<-factor(Datos_full$cluster_RA_10)
Datos_full$cluster_RA_11<-factor(Datos_full$cluster_RA_11)
Datos_full$cluster_RA_12<-factor(Datos_full$cluster_RA_12)
Datos_full$zona_metro<-factor(Datos_full$zona_metro)
Datos_full$Parada_bus<-factor(Datos_full$Parada_bus)
Datos_full$municipio <- factor(Datos_full$municipio, levels=c(28014,28123),labels = c("Arganda","Rivas"))
Datos_full$edad_cat<-factor(Datos_full$edad_cat,levels = c(1:6),labels=c("15 o menos","De 16 a 26","De 27 a 34","De 35 a 49","De 50 a 64","Mayor de 64"))
Datos_full$genero<-factor(Datos_full$genero,levels = c(1,2),labels=c("Hombre","Mujer"))
Datos_full$ingreso<-factor(Datos_full$ingreso,levels = c(1,2,3,4,5,99),labels=c("Menos_900","900_1600","1600_2500","2500_3000","Mas_3000","NS_NC"))
Datos_full$estudios<-factor(Datos_full$estudios,levels = c(1:4),labels=c("Sin_estudios","Estudios_primarios","Estudios_Secundarios","Estudios_Universitarios"))
Datos_full$sit_laboral<- factor(Datos_full$sit_laboral,levels=c(1:9),labels=c("Employed","Student","Employed_Student","Unpaid_household","Retire","Pensiones","Unemployed_Looking","Unemployed_Not_Looking","Other"))
Datos_full$vehiculo <- factor(Datos_full$vehiculo,levels=c(1:5),labels=c("No","Yes_Driver","Yes_ST_Driver","Yes_No_Driver","Yes_Passenger"))
Datos_full$carnet <- factor(Datos_full$carnet, levels=c(1:5),labels=c("NO","DeMoto","DeCoche","DeMotoYCoche","NoProcede"))
Datos_full$abono <-factor(Datos_full$abono,levels = c(2,1),labels=c("No","Yes"))
Datos_full$frec_madrid<- factor(Datos_full$frec_madrid,levels=c(1:3),labels=c("More_3days","1-3days","1_2month"))
Datos_full$frec_viaje<- factor(Datos_full$frec_viaje,levels=c(1:4),labels=c("4 o mas dias a la semana","1-3 dias a la semana","1-2 veces al mes","Menos de una vez al mes"))
Datos_full$modo <- factor(Datos_full$modo, levels= c(1:7),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional"))
Datos_full$modo_bis <- factor(Datos_full$modo_bis, levels= c(1:8),labels=c("Coche","Motocicleta","Bus","Metro","Taxi","VTC","Bus_Discrecional","R3"))
Datos_full$tipo_dia <- factor(Datos_full$tipo_dia, levels=c(1:7),labels = c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))
Datos_full$tipo_dia2 <- factor(Datos_full$tipo_dia2, levels=c("1","1","1","1","1","2","3"),labels = c("Weekday","Weekday","Weekday","Weekday","Weekday","Saturday","Sunday"))
Datos_full$motivo_viaje <- factor(Datos_full$motivo_viaje, levels=c(1:8),labels = c("Work_Studies","Working_Affairs","Personal_Affairs","Leisure","Shopping","Doctor","Visiting_Friends","Other"))
Datos_full$motivo_viaje_2<-factor(Datos_full$motivo_viaje_2, levels=c("1","2"),labels=c("Work_Studies","Non_Work_Studies"))
Datos_full$ruta<-factor(Datos_full$ruta,levels=c(1:2),labels=c("A3","R3"))
Datos_full$P15_B<-factor(Datos_full$P15_B,levels=c(1:2),labels=c("Conductor","Acompanante"))
Datos_full$hora_franja <- factor(Datos_full$hora_franja, levels=c("1","2","3","4","5","6"),labels = c("peak morning","non peak morning","afternoon","peak evening","non peak evening","night"))
Datos_full$solo <- factor(Datos_full$solo, levels = c(1:3),labels=c("Solo","Acompanado","Acompanado_Menores"))
Datos_full$combinar<- factor(Datos_full$combinar, levels = c(1:2),labels=c("Si","No"))
Datos_full$aspectos<- factor(Datos_full$aspectos, levels = c(1:4),labels=c("Tiempo de viaje por congestion (nivel de trafico)","Incidencias en el medio elegido: obras, accidentes, huelgas en transporte publico","Meteorologia","Protocolos de contaminacion en Madrid capital"))
Datos_full<-Datos_full %>% mutate(conocimiento=case_when(
current_toll_diff< -0.5 ~ 1,
current_toll_diff> 0.5 ~ 2,
current_toll == "No" ~ 3,
TRUE ~ 0
))
Datos_full$conocimiento<-factor(Datos_full$conocimiento)
Datos_full<-Datos_full %>% mutate(ahorrotiempo1=tiempo_viaje - Duracion_Coche_R3)
Datos_full<-Datos_full %>% mutate(tiempo2 = tiempo_viaje * tiempo_viaje)
openxlsx::write.xlsx(Datos_full,"Datos_full.xlsx")
dataSurveyA3<-Datos_full[,c("REGISTRO","municipio","seccion_censal","genero","edad","edad_cat","frec_madrid","sit_laboral","ingreso","estudios","carnet","vehiculo","abono","tipo_dia","P12","tiempo_viaje","motivo_viaje","modo","ruta","P15_B","combinar","solo","frec_viaje","aspectos","current_toll","current_toll_tarifa","wtp","wtp_tarifa","abono_mensual","abono_mensual_tarifa","carpooling","carpooling_descuento","elegiria_bus_arganda","elegiria_bus_rivas","elegiria_metro_arganda","elegiria_metro_rivas")]
usethis::use_data(dataSurveyA3, overwrite = T)
devtools::document()
library(surveyA3Madrid)
?surveyA3Madrid
?dataSurveyA3
usethis::use_build_ignore("raw")
devtools::document()
library(surveyA3Madrid)
library(surveyA3Madrid)
usethis::use_vignette("surveyA3Madrid-vignette")
install.packages("gitignore")
gitignore::gi_fetch_templates("R")
library(surveyA3Madrid)
?dataSurveyA3
?surveyA3Madrid
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(surveyA3Madrid)
?contingencyTables
devtools::document()
data("dataSurveyA3")
data("dataSurveyA3")
contingencyTables(dataSurveyA3$municipio,dataSurveyA3$edad_cat)
tabulate(dataSurveyA3$municipio,dataSurveyA3$edad_cat)
devtools::document()
library(surveyA3Madrid)
contingencyTables(dataSurveyA3$genero,dataSurveyA3$municipio)
?assign
deparse(substitute(dataSurveyA3))
devtools::document()
library(surveyA3Madrid)
contingencyTables(genero,municipio,dataSurveyA3)
contingencyTables("genero","municipio",dataSurveyA3)
dataset<-dataSurveyA3
x_1<-assign(paste0(deparse(substitute(dataset)),"$",x))
x<-"genero"
y<-"municipio"
x_1<-assign(paste0(deparse(substitute(dataset)),"$",x))
?assign()
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
assign(paste0(deparse(substitute(dataset)),"$",x),x)
assign(paste0(deparse(substitute(dataset)),"$",y),y)
table(x_1,y_1,useNA = c("ifany"))
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
assign(x_1,paste0(deparse(substitute(dataset)),"$",x))
assign(paste0(deparse(substitute(dataset)),"$",x),x_1)
assign(paste0(deparse(substitute(dataset)),"$",x),x)
assign(paste0(deparse(substitute(dataset)),"$",y),y)
table(x,y,useNA = c("ifany"))
table(assign(paste0(deparse(substitute(dataset)),"$",x),x),y,useNA = c("ifany"))
table(assign(paste0(deparse(substitute(dataset)),"$",x),x),assign(paste0(deparse(substitute(dataset)),"$",y),y),useNA = c("ifany"))
dataset<-dataSurveyA3
x<-genero
y<-municipio
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
library(tidyverse)
dataset %>% select(x)
dataset %>% select(y)
x_1<-dataset %>% select(x)
y_1<-dataset %>% select(y)
table(,useNA = c("ifany"))
table(x_1,y_1,useNA = c("ifany"))
names(dataset)
x_1<-list(dataset %>% select(x))
View(x_1)
y_1<-list(dataset %>% select(y))
table(x_1,y_1,useNA = c("ifany"))
as.vector(x_1)
x_1<-as.vector(dataset %>% select(x))
y_1<-as.vector(dataset %>% select(y))
table(x_1,y_1,useNA = c("ifany"))
View(x_1)
?table
?data_frame
?data_frame
?cbind
cbind()
cbind(dataset %>% select(x),dataset %>% select(y))
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
x_1<-dataset %>% select(x)
y_1<-dataset %>% select(y)
x<-cbind(x_1,y_1)
View(x)
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
x_1<-dataset %>% select(x)
y_1<-dataset %>% select(y)
aux<-cbind(x_1,y_1)
colnames(aux)[which(names(aux)==x)]<-"aux_1"
colnames(aux)[which(names(aux)==y)]<-"aux_2"
View(aux)
table(aux$aux_1,aux$aux_2,useNA = c("ifany"))
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
?which
data("dataSurveyA3")
x_1<-dataset[c(x,y)]
dataset<-dataSurveyA3
x_1<-dataset[c(x,y)]
dataset<-dataSurveyA3
x<-"genero"
y<-"municipio"
x_1<-dataset[c(x,y)]
colnames(aux)[which(names(aux)==x)]<-"aux_1"
colnames(aux)[which(names(aux)==y)]<-"aux_2"
colnames(x_1)[which(names(x_1)==x)]<-"aux_1"
colnames(x_1)[which(names(x_1)==y)]<-"aux_2"
View(x_1)
devtools::document()
devtools::document()
library(surveyA3Madrid)
contingencyTables("genero","municipio")
?contingencyTables
devtools::document()
library(surveyA3Madrid)
?contingencyTables
?dataSurveyA3
devtools::document()
library(surveyA3Madrid)
